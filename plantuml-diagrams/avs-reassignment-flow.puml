@startuml avs-reassignment-flow

' Basic styling
!theme plain
skinparam backgroundColor white
skinparam defaultTextAlignment center

' Explicitly disable handwritten mode
skinparam handwritten false
skinparam shadowing false
skinparam roundCorner 0

' Force straight lines
skinparam linetype ortho
skinparam ParticipantPadding 20
skinparam SequenceBoxPadding 10

' Make sure lines and fonts are crisp
skinparam ArrowColor black
skinparam ArrowThickness 1.5

title Task Reassignment Flow

actor Admin
participant "EvalAvsTaskManager" as TaskManager
participant "OriginalOperator" as OriginalOperator
participant "NewOperator" as NewOperator
participant "GoEvaluator" as GoEvaluator

note over Admin, GoEvaluator: Task Reassignment Process

Admin -> TaskManager: reassignTask(taskId)
activate TaskManager
TaskManager -> TaskManager: Check if task is expired
TaskManager -> TaskManager: Get next operator from queue
TaskManager -> TaskManager: Update task with new operator
TaskManager -> TaskManager: Emit EvalReassigned Event
deactivate TaskManager

TaskManager --> OriginalOperator: EvalReassigned Event
OriginalOperator -> OriginalOperator: Cancel task processing

TaskManager --> NewOperator: EvalReassigned Event
activate NewOperator
NewOperator -> NewOperator: Check if new assigned operator
NewOperator -> GoEvaluator: Start evaluation process
note right of NewOperator: Process follows normal evaluation flow
deactivate NewOperator
@enduml