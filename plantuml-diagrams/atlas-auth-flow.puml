@startuml
!option handwritten true

' Use improved fonts and spacing
skinparam sequenceMessageAlign center
skinparam backgroundColor white
skinparam defaultTextAlignment center

' Fix fonts and arrow styling
skinparam ArrowColor black
skinparam ArrowThickness 1.5
skinparam ParticipantFontSize 16
skinparam ParticipantFontStyle bold
skinparam ActorFontSize 16
skinparam ActorFontStyle bold
skinparam NoteFontSize 14
skinparam TitleFontSize 20
skinparam TitleFontStyle bold

' Color participants for better visualization
skinparam ActorBackgroundColor lightblue
skinparam ParticipantBackgroundColor lightyellow
skinparam NoteBackgroundColor lightgray

title User Authentication Flow

actor User
participant "Atlas Frontend" as Frontend
participant "Next Auth" as NextAuth
participant "Atlas API" as API
participant "AWS Cognito" as Cognito
participant "Database" as DB

note over User, DB: User Authentication Process

User -> Frontend: Login with email/password
activate Frontend
Frontend -> NextAuth: Submit credentials
NextAuth -> Cognito: Authenticate user
activate Cognito
Cognito --> NextAuth: Return JWT token
deactivate Cognito
NextAuth --> Frontend: Store auth token in session
Frontend --> User: Redirect to dashboard
deactivate Frontend

User -> Frontend: Access protected route
activate Frontend
Frontend -> API: Request data with auth token
activate API
API -> API: JWT middleware validates token
API -> Cognito: Verify token (if needed)
Cognito --> API: Token verification
API -> DB: Fetch authorized data
DB --> API: Return data
API --> Frontend: Return authorized data
deactivate API
Frontend --> User: Display content
deactivate Frontend
@enduml